/*! For license information please see poonya.browser.system.bundle.min.js.LICENSE.txt */
System.register("poonya",[],(function(t,e){return{execute:function(){t((()=>{var t={449:(t,e,s)=>{const{PoonyaStaticLibrary:n,FIELDFLAGS:r}=s(294),i=/"/g,a=/<([aA-zZ0-9]+)/;function o(t){return null===t?"null":void 0===t?"undefined":t.toString()}new class extends n{constructor(){super("default.html.tags",!1,!1,"TAGS"),this.addField("A","a",r.CONSTANT),this.addField("ABBR","abbr",r.CONSTANT),this.addField("ADDRESS","address",r.CONSTANT),this.addField("AREA","area",r.CONSTANT),this.addField("ARTICLE","article",r.CONSTANT),this.addField("ASIDE","aside",r.CONSTANT),this.addField("AUDIO","audio",r.CONSTANT),this.addField("B","b",r.CONSTANT),this.addField("BASE","base",r.CONSTANT),this.addField("BDI","bdi",r.CONSTANT),this.addField("BDO","bdo",r.CONSTANT),this.addField("BLOCKQUOTE","blockquote",r.CONSTANT),this.addField("BODY","body",r.CONSTANT),this.addField("BR","br",r.CONSTANT),this.addField("BUTTON","button",r.CONSTANT),this.addField("CANVAS","canvas",r.CONSTANT),this.addField("CAPTION","caption",r.CONSTANT),this.addField("CITE","cite",r.CONSTANT),this.addField("CODE","code",r.CONSTANT),this.addField("COL","col",r.CONSTANT),this.addField("COLGROUP","colgroup",r.CONSTANT),this.addField("DATA","data",r.CONSTANT),this.addField("DATALIST","datalist",r.CONSTANT),this.addField("DD","dd",r.CONSTANT),this.addField("DEL","del",r.CONSTANT),this.addField("DETAILS","details",r.CONSTANT),this.addField("DFN","dfn",r.CONSTANT),this.addField("DIALOG","dialog",r.CONSTANT),this.addField("DIV","div",r.CONSTANT),this.addField("DL","dl",r.CONSTANT),this.addField("DT","dt",r.CONSTANT),this.addField("EM","em",r.CONSTANT),this.addField("EMBED","embed",r.CONSTANT),this.addField("FIELDSET","fieldset",r.CONSTANT),this.addField("FIGCAPTION","figcaption",r.CONSTANT),this.addField("FIGURE","figure",r.CONSTANT),this.addField("FOOTER","footer",r.CONSTANT),this.addField("FORM","form",r.CONSTANT),this.addField("H1","h1",r.CONSTANT),this.addField("H2","h2",r.CONSTANT),this.addField("H3","h3",r.CONSTANT),this.addField("H4","h4",r.CONSTANT),this.addField("H5","h5",r.CONSTANT),this.addField("H6","h6",r.CONSTANT),this.addField("HEAD","head",r.CONSTANT),this.addField("HEADER","header",r.CONSTANT),this.addField("HR","hr",r.CONSTANT),this.addField("HTML","html",r.CONSTANT),this.addField("I","i",r.CONSTANT),this.addField("IFRAME","iframe",r.CONSTANT),this.addField("IMG","img",r.CONSTANT),this.addField("INPUT","input",r.CONSTANT),this.addField("INS","ins",r.CONSTANT),this.addField("KBD","kbd",r.CONSTANT),this.addField("LABEL","label",r.CONSTANT),this.addField("LEGEND","legend",r.CONSTANT),this.addField("LI","li",r.CONSTANT),this.addField("LINK","link",r.CONSTANT),this.addField("MAIN","main",r.CONSTANT),this.addField("MAP","map",r.CONSTANT),this.addField("MARK","mark",r.CONSTANT),this.addField("META","meta",r.CONSTANT),this.addField("METER","meter",r.CONSTANT),this.addField("NAV","nav",r.CONSTANT),this.addField("NOSCRIPT","noscript",r.CONSTANT),this.addField("OBJECT","object",r.CONSTANT),this.addField("OL","ol",r.CONSTANT),this.addField("OPTGROUP","optgroup",r.CONSTANT),this.addField("OPTION","option",r.CONSTANT),this.addField("OUTPUT","output",r.CONSTANT),this.addField("P","p",r.CONSTANT),this.addField("PARAM","param",r.CONSTANT),this.addField("PICTURE","picture",r.CONSTANT),this.addField("PRE","pre",r.CONSTANT),this.addField("PROGRESS","progress",r.CONSTANT),this.addField("Q","q",r.CONSTANT),this.addField("RUBY","ruby",r.CONSTANT),this.addField("RB","rb",r.CONSTANT),this.addField("RT","rt",r.CONSTANT),this.addField("RTC","rtc",r.CONSTANT),this.addField("RP","rp",r.CONSTANT),this.addField("S","s",r.CONSTANT),this.addField("SAMP","samp",r.CONSTANT),this.addField("SCRIPT","script",r.CONSTANT),this.addField("SECTION","section",r.CONSTANT),this.addField("SELECT","select",r.CONSTANT),this.addField("SMALL","small",r.CONSTANT),this.addField("SOURCE","source",r.CONSTANT),this.addField("SPAN","span",r.CONSTANT),this.addField("STRONG","strong",r.CONSTANT),this.addField("STYLE","style",r.CONSTANT),this.addField("SUB","sub",r.CONSTANT),this.addField("SUMMARY","summary",r.CONSTANT),this.addField("SUP","sup",r.CONSTANT),this.addField("TABLE","table",r.CONSTANT),this.addField("TBODY","tbody",r.CONSTANT),this.addField("TD","td",r.CONSTANT),this.addField("TEMPLATE","template",r.CONSTANT),this.addField("TEXTAREA","textarea",r.CONSTANT),this.addField("TFOOT","tfoot",r.CONSTANT),this.addField("TH","th",r.CONSTANT),this.addField("THEAD","thead",r.CONSTANT),this.addField("TIME","time",r.CONSTANT),this.addField("TITLE","title",r.CONSTANT),this.addField("TR","tr",r.CONSTANT),this.addField("TRACK","track",r.CONSTANT),this.addField("U","u",r.CONSTANT),this.addField("UL","ul",r.CONSTANT),this.addField("VAR","var",r.CONSTANT),this.addField("VIDEO","video",r.CONSTANT),this.addField("WBR","wbr",r.CONSTANT)}},new class extends n{constructor(){super("default.html",!1,!1,"html"),this.addLib("default.html.tags",r.CONSTANT),this.addField("createElement",this.createElement,r.CONSTANT),this.addField("getElementName",this.getElementName,r.CONSTANT),this.addField("isElement",this.isElement,r.CONSTANT),this.addField("createTag",this.createTag,r.CONSTANT),this.addField("closeTag",this.closeTag,r.CONSTANT)}createElement(t,e,s,n){if("string"==typeof e&&"string"==typeof s){let t=new Array;for(let e in n)t.push(`${e}="${o(n[e]).replace(i,'\\"')}"`);return`<${e} ${t.join(" ")}>${s}</${e}>`}return null}getElementName(t,e){return"string"==typeof e?e.match(a)[1]:null}isElement(t,e,s){return"string"==typeof e&&e.match(a)[1]==s}createTag(t,e,s){if("string"==typeof e){let t=new Array;for(let e in s)t.push(`${e}="${o(s[e]).replace(i,'\\"')}"`);return`<${e}${t.length>0?" "+t.join(" "):""}>`}return null}closeTag(t,e){return"string"==typeof e?`</${e}>`:null}}},548:(t,e,s)=>{const{PoonyaStaticLibrary:n,PoonyaPrototype:r,FIELDFLAGS:i,Exceptions:a}=s(294),o=new Date;new class extends n{constructor(){super("default.math",!1,!1,"math"),this.addField("floor",this.floor,i.CONSTANT),this.addField("round",this.round,i.CONSTANT),this.addField("ceil",this.ceil,i.CONSTANT),this.addField("abs",this.abs,i.CONSTANT)}ceil(t,e){return"number"!=typeof e||isNaN(e)?null:Math.ceil(e)}floor(t,e){return"number"!=typeof e||isNaN(e)?null:Math.floor(e)}round(t,e){return"number"!=typeof e||isNaN(e)?null:Math.round(e)}abs(t,e){return"number"!=typeof e||isNaN(e)?null:Math.abs(e)}},new class extends n{constructor(){super("default.regexp",!1,!1,"regexp"),this.addField("test",this.test,i.CONSTANT),this.addField("replace",this.replace,i.CONSTANT)}test(t,e,s,n){return new RegExp(e,s||void 0).test(n)}replace(t,e,s,n,r){return n.replace(new RegExp(e,s||void 0),r)}},new class extends n{constructor(){super("default.dates",!1,!1,"dates"),this.addField("minutes",this.minutes,i.CONSTANT),this.addField("seconds",this.seconds,i.CONSTANT),this.addField("month",this.month,i.CONSTANT),this.addField("hours",this.hours,i.CONSTANT),this.addField("year",this.year,i.CONSTANT),this.addField("day",this.day,i.CONSTANT),this.addField("now",this.now,i.CONSTANT)}year(){return o.getUTCFullYear()}month(){return o.getUTCMonth()}day(){return o.getUTCDay()}hours(){return o.getUTCHours()}minutes(){return o.getUTCMinutes()}seconds(){return o.getUTCSeconds()}now(){return Date.now()}},new class extends n{constructor(){super("default.numbers",!1,!1,"numbers"),this.addField("random",this.random,i.CONSTANT),this.addField("isNumber",this.isNumber,i.CONSTANT),this.addField("parseInt",this.parseInt,i.CONSTANT)}random(t,e,s){return"number"!=typeof e||"number"!=typeof s||isNaN(e)||isNaN(s)?Math.round(e+Math.random()*(s-e)):Math.random()}isNumber(t,e){return!isNaN(e)&&"number"==typeof e}parseInt(t,e){return isNaN(e=parseInt(e))?null:e}};class l extends r{constructor(){super([],"Object"),this.addField("create",this.create,i.CONSTANT|i.STATIC),this.addField("values",this.values,i.CONSTANT),this.addField("assign",this.assign,i.CONSTANT),this.addField("remove",this.remove,i.CONSTANT),this.addField("keys",this.keys,i.CONSTANT),this.addField("set",this.set,i.CONSTANT),this.addField("has",this.has,i.CONSTANT),this.addField("get",this.get,i.CONSTANT)}keys(){return this.keys()}values(){return this.values()}assign(t,...e){for(let t=0,s=e.length;t<s;t++)this.append(e[t])}set(t,e,s){this.set(t.context,e,s)}has(t,e){return this.has(e)}get(t,e){return this.get(e)}remove(t,e){this.delete(e)}create(){return new Object}}class u extends r{constructor(){super([],"Integer")}}class c extends r{constructor(){super([],"Number")}}class d extends r{constructor(){super([],"Boolean")}}class h extends r{constructor(){super([],"Null")}}class p extends r{constructor(t){super([],"String"),this.addField("charAt",this.charAt,i.CONSTANT,t),this.addField("length",this.length,i.CONSTANT|i.PROPERTY,t)}charAt(t,e){return null!=e?this.data.charAt(e):null}length(){return this.data.length}}class T extends r{constructor(t){super([],"Array"),this.addField("from",this.from,i.CONSTANT|i.STATIC,t),this.addField("includes",this.includes,i.CONSTANT,t),this.addField("indexOf",this.indexOf,i.CONSTANT,t),this.addField("concat",this.concat,i.CONSTANT,t),this.addField("append",this.append,i.CONSTANT,t),this.addField("length",this.length,i.CONSTANT,t),this.addField("remove",this.remove,i.CONSTANT,t),this.addField("slice",this.slice,i.CONSTANT,t),this.addField("pop",this.pop,i.CONSTANT,t)}from(t,...e){return e}includes(t,e){for(let s of this.fields)if(s.value.result(t.context,null,t.throw_error)==e)return!0;return!1}remove(t,e,s){("number"!=typeof e||isNaN(e))&&t.throw_error(t.position,new a.PoonyaException("From must have a number type")),("number"!=typeof s||isNaN(s))&&t.throw_error(t.position,new a.PoonyaException("To must have a number type"));const n=s-e;for(;e!=s;)this.remove(e),e+=n}indexOf(t,e){for(let[s,n]of this.fields)if(n.result(t.context,null,t.throw_error)==e)return s;return-1}length(){return this.fields.size}append(t,e){this.push(e)}concat(t,...e){for(let t=0,s=e.length;t<s;t++)for(let s=0,n=e[t].length;s<n;s++)this.push(e[t][s])}slice(t,e,s){("number"!=typeof e||isNaN(e))&&t.throw_error(t.position,new a.PoonyaException("From must have a number type")),("number"!=typeof s||isNaN(s))&&t.throw_error(t.position,new a.PoonyaException("To must have a number type"));const n=s-e,r=new Array;for(;e!=s;)r.push(this.get(e)),e+=n;return r}pop(){const t=this.fields.get(this.fields.size-1);return this.fields.remove(this.fields.size-1),t}}new class extends n{constructor(){super("default",!0),this.expandPrototype(l),this.expandPrototype(T),this.expandPrototype(p),this.expandPrototype(u),this.expandPrototype(d),this.expandPrototype(c),this.expandPrototype(h),this.addField("endd","\n\n",i.CONSTANT),this.addField("endl","\n",i.CONSTANT),this.addField("tab","\t",i.CONSTANT),this.addField("log",this.log,i.CONSTANT),this.addLib("default.numbers"),this.addLib("default.regexp"),this.addLib("default.dates"),this.addLib("default.math")}log(t,...e){console.log(...e)}}},245:t=>{"use strict";var e,s="object"==typeof Reflect?Reflect:null,n=s&&"function"==typeof s.apply?s.apply:function(t,e,s){return Function.prototype.apply.call(t,e,s)};e=s&&"function"==typeof s.ownKeys?s.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var r=Number.isNaN||function(t){return t!=t};function i(){i.init.call(this)}t.exports=i,t.exports.once=function(t,e){return new Promise((function(s,n){function r(){void 0!==i&&t.removeListener("error",i),s([].slice.call(arguments))}var i;"error"!==e&&(i=function(s){t.removeListener(e,r),n(s)},t.once("error",i)),t.once(e,r)}))},i.EventEmitter=i,i.prototype._events=void 0,i.prototype._eventsCount=0,i.prototype._maxListeners=void 0;var a=10;function o(t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}function l(t){return void 0===t._maxListeners?i.defaultMaxListeners:t._maxListeners}function u(t,e,s,n){var r,i,a,u;if(o(s),void 0===(i=t._events)?(i=t._events=Object.create(null),t._eventsCount=0):(void 0!==i.newListener&&(t.emit("newListener",e,s.listener?s.listener:s),i=t._events),a=i[e]),void 0===a)a=i[e]=s,++t._eventsCount;else if("function"==typeof a?a=i[e]=n?[s,a]:[a,s]:n?a.unshift(s):a.push(s),(r=l(t))>0&&a.length>r&&!a.warned){a.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=t,c.type=e,c.count=a.length,u=c,console&&console.warn&&console.warn(u)}return t}function c(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function d(t,e,s){var n={fired:!1,wrapFn:void 0,target:t,type:e,listener:s},r=c.bind(n);return r.listener=s,n.wrapFn=r,r}function h(t,e,s){var n=t._events;if(void 0===n)return[];var r=n[e];return void 0===r?[]:"function"==typeof r?s?[r.listener||r]:[r]:s?function(t){for(var e=new Array(t.length),s=0;s<e.length;++s)e[s]=t[s].listener||t[s];return e}(r):T(r,r.length)}function p(t){var e=this._events;if(void 0!==e){var s=e[t];if("function"==typeof s)return 1;if(void 0!==s)return s.length}return 0}function T(t,e){for(var s=new Array(e),n=0;n<e;++n)s[n]=t[n];return s}Object.defineProperty(i,"defaultMaxListeners",{enumerable:!0,get:function(){return a},set:function(t){if("number"!=typeof t||t<0||r(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");a=t}}),i.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},i.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||r(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},i.prototype.getMaxListeners=function(){return l(this)},i.prototype.emit=function(t){for(var e=[],s=1;s<arguments.length;s++)e.push(arguments[s]);var r="error"===t,i=this._events;if(void 0!==i)r=r&&void 0===i.error;else if(!r)return!1;if(r){var a;if(e.length>0&&(a=e[0]),a instanceof Error)throw a;var o=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw o.context=a,o}var l=i[t];if(void 0===l)return!1;if("function"==typeof l)n(l,this,e);else{var u=l.length,c=T(l,u);for(s=0;s<u;++s)n(c[s],this,e)}return!0},i.prototype.addListener=function(t,e){return u(this,t,e,!1)},i.prototype.on=i.prototype.addListener,i.prototype.prependListener=function(t,e){return u(this,t,e,!0)},i.prototype.once=function(t,e){return o(e),this.on(t,d(this,t,e)),this},i.prototype.prependOnceListener=function(t,e){return o(e),this.prependListener(t,d(this,t,e)),this},i.prototype.removeListener=function(t,e){var s,n,r,i,a;if(o(e),void 0===(n=this._events))return this;if(void 0===(s=n[t]))return this;if(s===e||s.listener===e)0==--this._eventsCount?this._events=Object.create(null):(delete n[t],n.removeListener&&this.emit("removeListener",t,s.listener||e));else if("function"!=typeof s){for(r=-1,i=s.length-1;i>=0;i--)if(s[i]===e||s[i].listener===e){a=s[i].listener,r=i;break}if(r<0)return this;0===r?s.shift():function(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}(s,r),1===s.length&&(n[t]=s[0]),void 0!==n.removeListener&&this.emit("removeListener",t,a||e)}return this},i.prototype.off=i.prototype.removeListener,i.prototype.removeAllListeners=function(t){var e,s,n;if(void 0===(s=this._events))return this;if(void 0===s.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==s[t]&&(0==--this._eventsCount?this._events=Object.create(null):delete s[t]),this;if(0===arguments.length){var r,i=Object.keys(s);for(n=0;n<i.length;++n)"removeListener"!==(r=i[n])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(e=s[t]))this.removeListener(t,e);else if(void 0!==e)for(n=e.length-1;n>=0;n--)this.removeListener(t,e[n]);return this},i.prototype.listeners=function(t){return h(this,t,!0)},i.prototype.rawListeners=function(t){return h(this,t,!1)},i.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):p.call(t,e)},i.prototype.listenerCount=p,i.prototype.eventNames=function(){return this._eventsCount>0?e(this._events):[]}},62:(t,e,s)=>{"use strict";const{OPERATOR:n}=s(635);class r{constructor(t="undefined"){this.type=t}}t.exports.Operand=class extends r{constructor(t="undefined"){super("operand"),this.name=t}},t.exports.Operator=class extends r{constructor(t){switch(super("operator"),this.position=t.position,this.raw=t.data,t.data.toString()){case"+":this.op_p=n.PLUS;break;case"-":this.op_p=n.MINUS;break;case"*":this.op_p=n.MULT;break;case"/":this.op_p=n.DIVIDE;break;case">":this.op_p=n.LARGER;break;case"<":this.op_p=n.LESS;break;case">=":this.op_p=n.ELARGER;break;case"<=":this.op_p=n.ELESS;break;case"=":this.op_p=n.EQUAL;break;case"!=":this.op_p=n.NEQUAL;break;case"&":this.op_p=n.AND;break;case"|":this.op_p=n.OR}}equals(t){return this.op_p===t}toString(){return this.raw.toString()}},t.exports.ParserData=r},492:(t,e,s)=>{"use strict";const{Operand:n}=s(62),{SERVICE:r}=s(635),{NativeFunctionExecutionError:i}=s(707),{iPoonyaObject:a,iPoonyaPrototype:o}=s(779);class l{constructor(t){this.target=t,this.name=t.name}result(t=null,e,s,u,c,d){let h,p=new Array;for(let t=0,n=e.length;t<n;t++)p.push(e[t].result(s,u,d).result(s,u,d));try{h=this.target.call(t,{args:e,context:s,throw_error:d,position:c},...p)}catch(t){d(c,new i(this.target.name,t.stack))}switch(typeof h){case"bigint":return s.createObject(h,-1,r.CONSTRUCTORS.INTEGER,null);case"number":return s.createObject(h,-1,r.CONSTRUCTORS.NUMBER,null);case"string":return s.createObject(h,-1,r.CONSTRUCTORS.STRING,null);case"symbol":return s.createObject(Symbol.keyFor(h),-1,r.CONSTRUCTORS.STRING,null);case"boolean":return s.createObject(h,-1,r.CONSTRUCTORS.BOOLEAN,null);case"undefined":return s.createObject(h,-1,r.CONSTRUCTORS.NULL,null);case"object":switch(!0){case null===h:return s.createObject(h,-1,r.CONSTRUCTORS.NULL,null);case h instanceof a:case h instanceof n:case h instanceof o:return h;default:return Array.isArray(h)?s.createObject(h,-1,r.CONSTRUCTORS.ARRAY,null):s.createObject(h,-1,r.CONSTRUCTORS.OBJECT,null)}case"function":return new l(h)}}}t.exports=l},358:(t,e,s)=>{"use strict";const{FIELDFLAGS:n}=s(635),r=s(940),i=s(492);class a extends r{constructor(t=null,e,s){if(super(t),e)if(Array.isArray(e))for(let t=0,n=e.length;t<n;t++)this.push(s,e[t]);else for(let t in e)switch(typeof t){case"string":this.set(s,parseInt(t),e[t]);break;case"number":this.set(s,t,e[t])}}clone(){const t=new a(this.prototype);return t.fields=new Map(this.fields),t.field_attrs=new Map(this.field_attrs),t}push(t,e,s=new Array){this.set(t,this.fields.size,e,s)}result(t,e,s){let r,a=new Array(this.fields.size);for(let[o,l]of this.fields)r=this.field_attrs.get(o),null!=r&&0!=(r&n.NOOUTPUT)||(a[o]=l instanceof i?null!=l?l.target:null:null!=l?l.result(t,e,s):null);return a}toRawData(){return`[Array:${this.prototype.name}]`}}t.exports=a},221:(t,e,s)=>{"use strict";const n=s(940);class r extends n{constructor(t=null,e){super(t),this.data=e}append(t){this.data=t}clone(){return new r(this.prototype,this.data)}set(){}remove(){}result(){return this.data}toRawData(){return this.data}}t.exports=r},159:(t,e,s)=>{"use strict";const n=s(940);class r extends n{constructor(t=null,e){super(t),this.data=e}clone(){return new r(this.prototype,this.data)}append(t){this.data=t}set(){}remove(){}result(){return this.data}toRawData(){return this.data}}t.exports=r},486:(t,e,s)=>{"use strict";const n=s(940);class r extends n{constructor(t=null){super(t)}clone(){return new r(this.prototype)}append(){}set(){}remove(){}result(){return null}toRawData(){return null}}t.exports=r},773:(t,e,s)=>{"use strict";const n=s(940);class r extends n{constructor(t=null,e){super(t),this.data=e}clone(){return new r(this.prototype,this.data)}append(t){this.data=t}set(){}remove(){}result(){return this.data}toRawData(){return this.data}}t.exports=r},940:(t,e,s)=>{"use strict";const{BadKeyInvalidTypeException:n,BadKeyProtectedFieldException:r}=s(707),{SUPER_CALL:i,GET:a,FIELDFLAGS:o,CONFIG:l}=s(635),{Cast:u}=s(270),{iPoonyaObject:c,iPoonyaPrototype:d}=s(779),h=s(492);class p extends c{constructor(t,e,s){super(),this.fields=new Map,this.field_attrs=new Map,this.raw=!1,t instanceof d&&(t[i](this),this.prototype=t),null!=e&&this.append(s,e)}clone(){const t=new p(this.prototype);return t.fields=new Map(this.fields),t.field_attrs=new Map(this.field_attrs),t}has(t){return this.fields.has(t)}remove(t){return this.fields.delete(t)&&this.field_attrs.delete(t)}get(t,e){let s=this.fields.get(t);return null!=s?s:this.prototype[a](t,e,!1)}setConstant(t){let e=0;if(null==(e=this.field_attrs.get(t)))throw new Error("Cannot find filed "+t+" in "+this.prototype.name+".Object");this.field_attrs.set(t,e|o.CONSTANT)}setHide(t){let e=0;if(null==(e=this.field_attrs.get(t)))throw new Error("Cannot find filed "+t+" in "+this.prototype.name+".Object");this.field_attrs.set(t,e|o.NOOUTPUT)}append(t,e){if("object"!=typeof e)throw new TypeError;if(Array.isArray(e))for(let s=0,n=e.length;s<n;s++)this.set(t,s,e[s],e);else if(e instanceof p)for(let s of e.fields)this.set(t,s[0],s[1]);else for(let s in e)this.set(t,s,e[s])}set(t,e,s,i=new Array){if("string"!=typeof e&&"number"!=typeof e)throw new n;const a=this.field_attrs.get(e);if(null!=a&&0==(a&o.CONSTANT))throw new r;try{this.fields.set(e,u(s,t,i))}catch(t){throw l.DEBUG&&console.error(t),new Error("Error when cast value of "+e)}}toString(t,e,s){let n=this.fields.get("toString");return null!=n?n.result(t,e,s):`[Object${this.prototype.name}]`}result(t,e,s){let n,r=new Object;for(let[i,a]of this.fields)n=this.field_attrs.get(i),null!=n&&0!=(n&o.NOOUTPUT)||(r[i]=a instanceof h?null!=a?a.target:null:null!=a?a.result(t,e,s):null);return r}toRawData(){return`[Object:${this.prototype.name}]`}}t.exports=p},406:(t,e,s)=>{"use strict";const{IS:n,GET:r,FIELDFLAGS:i,SUPER_CALL:a}=s(635),{iPoonyaPrototype:o}=s(779),{Cast:l}=s(270);class u extends o{constructor(t=[],e){if(super(),null!=t.find((t=>!(t instanceof o))))throw new Error("Only descendants of iPoonyaPrototype should be specified as parents of the target class");if("string"!=typeof e&&null!=e)throw new Error("Only string value can be passed as name");this.name=null!=e?e:"Object",this._parents=[...t],this._fields_data=new Map,this._fields=new Map}clone(){const t=new u(this._parents,this.name);return t._fields=new Map(this._fields),t._fields_data=new Map(this._fields_data),t}expand(t){if(!(t instanceof o))throw new TypeError("Parent must be an iPoonyaPrototype instance.");this._parents.push(t)}addField(t,e,s,n){this._fields.set(t,l(e,n)),this._fields_data.set(t,s)}[n](t){if(t===this.name)return!0;for(let e=0,s=this._parents;e<s;e++)if(this._parents[n](t))return!0;return!1}[r](t,e,s=!0){let n;if(null!=(n=this._fields.get(t)))return s&&0==(this._fields_data.get(t)&i.STATIC)?null:n;for(let r=0,i=this._parents.length;r<i;r++)if(null!=(n=this._parents[r].get(t,e,s)))return n;return null}[a](t){for(let[e,s]of this._fields_data)t.field_attrs.set(e,s);for(let e=0,s=this._parents.length;e<s;e++)this._parents[e][a](t)}toRawData(){return`[Prototype:${this.name}]`}}t.exports=u},718:(t,e,s)=>{"use strict";const n=s(940);class r extends n{constructor(t=null,e){super(t),this.data=e}clone(){return new r(this.prototype,this.data)}append(t){this.data=t}get(t,e){let s=this.data[t];return"string"==typeof s?new r(this.prototype,s):super.get(t,e)}set(){}remove(){}result(){return this.data}toRawData(){return this.data}}t.exports=r},606:(t,e,s)=>{"use strict";const{Operand:n,Operator:r}=s(62),{CHARTYPE:i,OPERATOR:a,SERVICE:o}=s(635),{UnableToRecognizeTypeException:l,TheSequenceException:u}=s(707),{Cast:c}=s(270),d=s(552);class h extends n{constructor(t,e){super("expression"),this.data=null!=e?[...e]:new Array,this.position=t,this.validated=!1}isNotDone(){return this.data[this.data.length-1]instanceof r}toString(t){return this.data.map((e=>e.toString(t))).join(" ")}append(t,e){let s;switch(t.type){case i.NUMBER:s=new d(o.CONSTRUCTORS.NUMBER,parseInt(t.data.toString()),t.position);break;case i.STRING:s=new d(o.CONSTRUCTORS.STRING,t.data.toString(),t.position);break;case i.OPERATOR:s=new r(t);break;case i.WORD:switch(t.data.toString()){case"true":s=new d(o.CONSTRUCTORS.BOOLEAN,!0,t.position);break;case"false":s=new d(o.CONSTRUCTORS.BOOLEAN,!1,t.position);break;case"null":s=new d(o.CONSTRUCTORS.NULL,null,t.position)}break;default:t instanceof r||t instanceof n?s=t:e(t.position,new l(t.type))}0!==this.data.length?(s instanceof r&&this.data[this.data.length-1]instanceof r||s instanceof n&&this.data[this.data.length-1]instanceof n)&&e(t.position,new u(s,this.data[this.data.length-1])):s instanceof r&&e(t.position,new u(s,"[ExpressionStart]")),this.data.push(s)}complete(t){if(this.data.filter((t=>t.op_p===a.MULT||t.op_p===a.DIVIDE)).length>0){let e=!1,s=Array.from(this.data),n=null;this.data.splice(0,this.data.length);for(let r=0,i=s.length;r<i;r++){if(s[r+1]&&"operator"===s[r+1].type)switch(s[r+1].op_p){case a.MULT:case a.DIVIDE:if(e)break;e=!0,n=new h(s[r+1].position),this.append(n,t);break;case a.PLUS:case a.MINUS:case a.EQUAL:case a.LARGER:case a.LESS:case a.OR:case a.AND:if(!e)break;e=!1,n.append(s[r],t),n.complete(),n=null;continue}e?n.append(s[r],t):this.append(s[r],t)}}if(this.data.filter((t=>t.op_p===a.AND)).length>0){let e=Array.from(this.data),s=new h(e[0].position);this.data.splice(0,this.data.length);for(let n=0,r=e.length;n<r;n++)e[n]&&"operator"===e[n].type&&e[n].op_p===a.AND?(s.complete(),this.append(s,t),this.append(e[n],t),s=new h(e[n].position)):s.append(e[n],t);s.complete(),this.append(s,t)}if(this.data.filter((t=>t.op_p===a.OR)).length>0){let e=Array.from(this.data),s=new h(e[0].position);this.data.splice(0,this.data.length);for(let n=0,r=e.length;n<r;n++)e[n]&&"operator"===e[n].type&&e[n].op_p===a.OR?(s.complete(),this.append(s,t),this.append(e[n],t),s=new h(e[n].position)):s.append(e[n],t);s.complete(),this.append(s,t)}this.validated=!0}result(t,e,s){let n=null!=this.data[0]?this.data[0].result(t,e,s).result(t,e,s):null;for(let r,i=1,o=this.data.length;i<o;i+=2)switch(r=this.data[i+1].result(t,e,s),!0){case this.data[i].equals(a.PLUS):n+=r.toRawData();break;case this.data[i].equals(a.MINUS):n-=r.toRawData();break;case this.data[i].equals(a.MULT):n*=r.toRawData();break;case this.data[i].equals(a.DIVIDE):n/=r.toRawData();break;case this.data[i].equals(a.LARGER):n=n>r.toRawData();break;case this.data[i].equals(a.LESS):n=n<r.toRawData();break;case this.data[i].equals(a.EQUAL):n=n==r.toRawData();break;case this.data[i].equals(a.ELARGER):n=n>=r.toRawData();break;case this.data[i].equals(a.ELESS):n=n<=r.toRawData();break;case this.data[i].equals(a.NEQUAL):n=n!=r.toRawData();break;case this.data[i].equals(a.AND):if(n=n&&r.toRawData(),!n)return n;break;case this.data[i].equals(a.OR):if(n=n||r.toRawData(),n)return n}return c(n,t)}}t.exports=h},584:(t,e,s)=>{"use strict";const{Operand:n}=s(62),{UnableToCreateAnObjectException:r,FieldNotAFunctionException:i}=s(707),{iPoonyaPrototype:a}=s(779),o=s(492);t.exports=class extends n{constructor(t,e,s){super("call function"),this.query_stack=[...t],this.position=s,this.args=e}result(t,e,s){const n=t.getByPath(this.query_stack,this.position,null,s,!0);if(n.instance instanceof o)return n.instance.result(n.parent,this.args,t,e,this.position,s);n.instance instanceof a?s(this.position,new r):s(this.position,new i(this.query_stack[this.query_stack.length-1]))}toString(){return"("+this.query_stack.join(" => ")+") <== ("+this.args.join(", ")+")"}}},46:(t,e,s)=>{"use strict";const{Operand:n}=s(62),{SERVICE:r,FIELDFLAGS:i}=s(635),a=s(492);t.exports=class extends n{constructor(t,e){super("get"),this.position=t,this.query_stack=e}result(t,e,s){const n=t.getByPath(this.query_stack,this.position,null,s,!0);return null!=n.instance?n.instance instanceof a?0!=(n.flags&i.PROPERTY)?n.instance.result(n.parent,[],t,e,this.position,s):t.createObject(`[NativeCode:${n.instance.name}]`,this.position,r.CONSTRUCTORS.STRING,s):n.instance:t.createObject(null,this.position,r.CONSTRUCTORS.NULL,s)}toString(){return"("+this.query_stack.join(" => ")+")"}}},552:(t,e,s)=>{"use strict";const{Operand:n}=s(62),{SERVICE:r}=s(635);class i extends n{constructor(t,e,s){super("object-creator"),this.query_stack=null!=t?t:r.CONSTRUCTORS.OBJECT,this.initial=e,this.position=s}toString(t="\t"){if(this.initial instanceof Map){const e=[...this.initial.entries()];return"new ("+this.query_stack.map((t=>"string"!=typeof t?`[${t.toString()}]`:t.toString())).join(" => ")+") -> "+(e.length>0?"\n"+e.map(((s,n)=>s[1]instanceof i?t+s[0]+" -> "+s[1].toString(t+"\t"):t+s[0]+" -> "+s[1].toString(t+"\t")+(n+1!=e.length?",":""))).join("\n"):"*")}return`(${this.initial}) <- (${this.query_stack.map((t=>"string"!=typeof t?`[${t.toString()}]`:t.toString())).join(" => ")})`}result(t,e,s){return t.createObject(this.initial,this.position,this.query_stack,s)}}t.exports=i},51:(t,e,s)=>{"use strict";const{Operand:n}=s(62);t.exports=class extends n{constructor(t,e,s){super("ternar"),this.condition=t,this.v_o=e,this.v_t=s}toString(t){return"< "+this.condition.toString(t+"\t")+" > ? "+this.v_o+" : "+this.v_t}result(t,e,s){return t.toBooleanResult(this.condition.result(t,e,s))?this.v_o.result(t,e,s):this.v_t.result(t,e,s)}}},350:t=>{"use strict";t.exports=class{constructor(t,e,s){this.condition=t,this.body_true=e,this.body_false=s}toString(t){return"if ("+this.condition.toString(t)+") "+this.body_true.toString(t)+(null!=this.body_false?" else "+this.body_false.toString(t):"")}result(t,e,s){t.toBooleanResult(this.condition.result(t,e,s))?this.body_true.result(t,e,s):null!=this.body_false&&this.body_false.result(t,e,s)}}},674:t=>{"use strict";t.exports=class{constructor(t){this.expression=t,this.position=t.position}toString(){return"> "+this.expression.toString()}result(t,e,s){e.write(this.expression.result(t,e,s).result(t,e,s))}}},834:(t,e,s)=>{"use strict";const n=s(606),{TheFieldMustBeAnArrayInstanceExceprion:r,GetFieldOfNullException:i}=s(707),a=s(358),o=s(940);t.exports=class{constructor(t,e,s){this.query_stack=e,this.position=t,this.value=s}toString(t){return"("+this.query_stack.map((t=>"number"==typeof t?`[${t}]`:t)).join(" => ")+") <- "+this.value.toString(t+"\t")}result(t,e,s){let l=t.get(this.query_stack[0]),u=[...this.query_stack];if(l instanceof o){let i=1;for(let r=u.length;l&&i<r;i++)u[i]instanceof n&&(u[i]=u[i].result(t,e,s).toRawData()),l=l.get(u[i])||null;l instanceof a?l.push(t,this.value.result(t,e,s)):s(this.position,new r(u[i-1]))}else s(this.position,new i(u[0]))}}},511:(t,e,s)=>{"use strict";const{TheFieldMustBeNumberException:n}=s(707),r=s(773);t.exports=class{constructor(t,e,s){this.from=t,this.to=e,this.body=s}toString(t){return"repeat ("+this.from.toString(t)+"; "+this.to.toString(t)+") "+this.body.toString(t)}result(t,e,s){let i,a=this.from.result(t,e,s),o=this.to.result(t,e,s);for(a instanceof r||s(this.from.position,new n("From")),o instanceof r||s(this.to.position,new n("To")),i=(a=Math.floor(a.result(t,e,s)))<(o=Math.floor(o.result(t,e,s)))?1:-1;a!=o;)t.addLevel(),t.set("current",a,"up"),this.body.result(t,e,s,!1),a+=i,t.popLevel()}}},436:(t,e,s)=>{"use strict";const n=s(606),{iPoonyaObject:r}=s(779),{TheFieldNotHasDeclaredExceprion:i,GetFieldOfNullException:a}=s(707);t.exports=class{constructor(t,e,s){this.query_stack=e,this.position=t,this.value=s}toString(t){return"("+this.query_stack.map((t=>"number"==typeof t?`[${t}]`:t)).join(" => ")+") = "+this.value.toString(t+"\t")}result(t,e,s){let o=t.get(this.query_stack[0]),l=[...this.query_stack];if(l.length>1){let i=1;for(let r=l.length-1;o&&i<r;i++)l[i]instanceof n&&(l[i]=l[i].result(t,e,s).toRawData()),o=o.get(l[i])||null;if(o instanceof r){const r=l[l.length-1];o.set(t,r instanceof n?r.result(t,e,s).toRawData():r,this.value.result(t,e,s))}else s(this.position,new a(l[i]))}else null!=o?t.set(l[0],this.value.result(t,e,s)):s(this.position,new i(l[0]))}}},113:t=>{"use strict";t.exports=class{constructor(){this.Sequence=new Array}push(t){this.Sequence.push(t)}result(t,e,s,n=!0){n&&t.addLevel();for(let n=0,r=this.Sequence.length;n<r;n++)this.Sequence[n].result(t,e,s);n&&t.popLevel()}toString(t=0){return`{\n${t}${this.Sequence.map((e=>e.toString(t+"\t"))).join("\n\n"+t)}\n${t.substring(0,t.length-1)}}`}}},998:t=>{"use strict";t.exports=class{constructor(t){this.Sequence=Array.isArray(t)?t:new Array}push(t){this.Sequence.push(t)}result(t,e,s){for(let n=0,r=this.Sequence.length;n<r;n++)this.Sequence[n].result(t,e,s)}toString(t="\t"){return`{\n${t}${this.Sequence.map((e=>e.toString(t+"\t"))).join("\n\n"+t)}\n${t.substring(0,t.length-1)}}`}}},259:(t,e,s)=>{"use strict";const{TheFieldAlreadyHasBeenDeclaredException:n}=s(707);t.exports=class{constructor(t,e){this.name=t.toString(),this.position=t.position,this.value=e}toString(t){return"set "+this.name+" = "+this.value.toString(t+"\t")}result(t,e,s){t.has(this.name,"up")?s(this.position,new n(this.name)):t.set(this.name,this.value.result(t,e,s),"up")}}},114:t=>{"use strict";t.exports=class{constructor(t,e){this.condition=t,this.body=e}toString(t){return"while ("+this.condition.toString(t)+") "+this.body.toString(t)}result(t,e,s){for(;t.toBooleanResult(this.condition.result(t,e,s));)this.body.result(t,e,s)}}},707:(t,e,s)=>{"use strict";const{SERVICE:n}=s(635),{dirname:r}=s(386);class i{constructor(t,e){this.message="PoonyaException / "+t+(null!=e?": \n"+e:"")}toString(){return this.message}}class a extends i{constructor(t,e){super("Parser exception / "+t,e)}}class o extends i{constructor(t,e){super("Linker exception / "+t,e)}}class l extends o{constructor(t){super("An error occured while opening file: '"+t+"'")}}t.exports.IOError=l,t.exports.LinkerIOError=class extends l{constructor(t){super(t)}},t.exports.LinkerException=o,t.exports.PoonyaException=i,t.exports.ParserException=a,t.exports.TheSequenceException=class extends a{constructor(t,e){super(`Wrong order: condition operator: '${t.toString()}' after '${e.toString()}'`)}},t.exports.ParserLogicException=class extends a{constructor(){super("The expression has incorrect logic")}},t.exports.GetFieldOfNullException=class extends i{constructor(t){super(`Cannot get property '${t}' of null`)}},t.exports.BadEmptyObjectException=class extends a{constructor(){super("Cannot create an empty object after declaring its keys")}},t.exports.UnexpectedTokenException=class extends a{constructor(t,e){super(`Unexpected token '${t.toString()}' when expected '${e.toString()}'`)}},t.exports.UnexpectedTokenStatement=class extends a{constructor(t,e,s){super(`Error parsing the '${t.toString()}' statement. Expected '${s.toString()}', when actually: '${e.toString()}'`)}},t.exports.FieldNotAFunctionException=class extends i{constructor(t){super(`The field '${t}' is not a function`)}},t.exports.BadKeyInvalidTypeException=class extends i{constructor(){super("Wrong key type: it can be set only by a numeric or string key")}},t.exports.IsNotAConstructorException=class extends i{constructor(t){super(`${t.map((t=>"number"==typeof t?"["+t+"]":t.toString())).join(" -> ")} - not a constructor`)}},t.exports.ParserEmtyArgumentException=class extends a{constructor(){super("It is not possible to pass an empty argument to a function, use null to denote an empty value")}},t.exports.LinkerPathNotGiveException=class extends o{constructor(){super("To use include, you must pass the path to the current execution file")}},t.exports.CriticalParserErrorException=class extends a{constructor(){super("Critical parser error")}},t.exports.NativeFunctionExecutionError=class extends i{constructor(t,e){const s=/^\s*at\s(?:new\s)?([aA-zZ.аА-яЯё]+)\s\((.*)\)$/;for(let t,i=0,a=(e=e.split("\n")).length;i<a;i++)if(s.test(e[i])&&(t=e[i].match(s),"NativeFunction.result"===t[1]&&n.ROOTPATH==r(t[2]).substring(0,n.ROOTPATH.length))){e=e.slice(0,i);break}super("Critical error while executing a native function '"+t+"'","* > \t"+e.join("\n * > \t"))}},t.exports.BadKeyProtectedFieldException=class extends i{constructor(){super("Cannot set this field, the field is protected from changes")}},t.exports.TheFieldMustBeNumberException=class extends i{constructor(t){super(`'${t}' must be a number, or a container containing a number`)}},t.exports.NativeFunctionReturnValueError=class extends i{constructor(){super("Function can only return simple types")}},t.exports.UnableToRecognizeTypeException=class extends a{constructor(t){super(`Unable to recognize type '${t}'`)}},t.exports.TheFieldNotHasDeclaredExceprion=class extends i{constructor(t){super(`Field '${t}' is not declared`)}},t.exports.UnableToCreateAnObjectException=class extends i{constructor(){super("Unable to create an object by calling its constructor as a function, pick ConstructorName -> *;")}},t.exports.BadArrowNotationJumpingTwoLevels=class extends a{constructor(){super("Bad array notation: jumping two levels is not possible")}},t.exports.UnexpectedWordTypeAndGetException=class extends a{constructor(t,e){super(`Expected word type expression and get ${t}[${e}]`)}},t.exports.ParserUnfinishedNotationException=class extends a{constructor(){super("Parser fault: unfinished notation")}},t.exports.BadArrowNotationJumpingToUpperLevel=class extends a{constructor(){super("Bad array notation: unexpected transition to a upper level")}},t.exports.TheFieldMustBeAnArrayInstanceExceprion=class extends i{constructor(t){super(`Field '${t}' must be an Array instance`)}},t.exports.TheFieldAlreadyHasBeenDeclaredException=class extends i{constructor(t){super(`The '${t}' field is already declared`)}},t.exports.SegmentationFaultEmptyArgumentException=class extends a{constructor(t){super("Segmentation fault: empty argument for "+t)}},t.exports.InvalidSequenceForLetiableAccessException=class extends a{constructor(){super("Invalid sequence for letiable access")}},t.exports.CriticalParserErrorUnexpectedEndOfExpression=class extends a{constructor(){super("Critical parser error: unexprected end of expression")}},t.exports.CriticalParserErrorUnexpectedEndOfInputException=class extends a{constructor(){super("Critical parser error: unexpected end of input")}},t.exports.CriticalParserErrorNoRawDataTransmittedException=class extends a{constructor(){super("Critical parser error: no raw data transmitted")}},t.exports.SegmentationFaultMaximumSegmentsForBlockException=class extends a{constructor(t){super("Segmentation fault exceeded the maximum number of segments for block "+t)}}},779:t=>{"use strict";t.exports.iContext=class{},t.exports.iPoonyaObject=class{},t.exports.iPoonyaPrototype=class{},t.exports.iPoonyaConstructsData=class{constructor(){}}},635:(t,e,s)=>{"use strict";const{EventEmitter:n}=s(245),r=Symbol("GET"),i=Symbol("IS"),a=Symbol("SEPER_CALL"),o=Symbol.for("POONYA-"+Math.floor(Math.random()*Number.MAX_SAFE_INTEGER)+"-win32"),l={CONSTRUCTORS:{OBJECT:["Object"],ARRAY:["Array"],BOOLEAN:["Boolean"],STRING:["String"],NUMBER:["Number"],INTEGER:["Integer"],NULL:["Null"]},CONFIG:{DEBUG:!1},LOADED:!1,ACTIONS:new n,get SPACE(){return s.g[o]}};l.ACTIONS.on("load",(()=>l.LOADED=!0)),t.exports.FIELDFLAGS={NOOUTPUT:1,CONSTANT:2,STATIC:4,PROPERTY:8},t.exports.SUPER_CALL=a,t.exports.NAMESPACE=o,t.exports.OPERATOR={PLUS:0,MINUS:1,MULT:2,DIVIDE:3,EQUAL:4,NEQUAL:5,LARGER:6,LESS:7,ELARGER:8,ELESS:9,AND:10,OR:11},t.exports.CHARTYPE={START:0,NUMBER:2,WORD:3,SPACE:4,POINT:5,STRING:6,NEWLINE:7,OPERATOR:8},t.exports.SERVICE=l,t.exports.CONFIG=l.CONFIG,t.exports.GET=r,t.exports.IS=i},392:(t,e,s)=>{"use strict";const n=s(513),{parser:r}=s(909),{GetFieldOfNullException:i,IsNotAConstructorException:a}=s(707),{GET:o,SERVICE:l,IS:u}=s(635),{Cast:c,toBytes:d}=s(270),{iContext:h,iPoonyaPrototype:p}=s(779),{PoonyaStaticLibrary:T}=s(239),f=s(492),O=s(606),N=s(940),S=s(358),E=s(159),y=s(773),A=s(718),w=s(221),g=s(486);class m extends Map{constructor(t,e){super(),null!=e&&this.append(t,e)}append(t,e){if("object"!=typeof e)throw new TypeError;if(Array.isArray(e))for(let s=0,n=e.length;s<n;s++)this.set(t,s,e[s]);else if(e instanceof N)for(let s of e.fields)this.set(t,s[0],s[1]);else if(e instanceof m)for(let s of e)this.set(t,s[0],s[1]);else for(let s in e)this.set(t,s,e[s])}get(t){return super.get(t)}set(t,e,s,n=new Array){if("string"!=typeof e&&"number"!=typeof e)throw new TypeError("Bad key "+e);try{super.set(e,c(s,t,n))}catch(t){console.error("Error when cast value of "+e),console.log(t)}}result(t,e,s){let n=new Object;for(let[r,i]of this)n[r]=i instanceof f?null!=i?i.result(t,e,s):null:null!=i?i.target:null;return n}}class R extends h{constructor(t,e,...s){super(),this.levels=new Array,this._lib_cache=new Array,null!=t&&this.import(t,e),this.levels.push(...s.map((t=>t instanceof m?t:"object"==typeof t?new m(this,t):null)).filter((t=>null!==t)))}import(t,e){if(null!=t){this.levels.push(new m(this,null));for(let s,n=0,r=t.length;n<r;n++)t[n]instanceof T&&!this._lib_cache.includes(t[n].namespace)&&(t[n].global?t[n].importTo(this.levels[0],this,e):(s=this.createObject(null,-1,l.CONSTRUCTORS.OBJECT,e),t[n].importTo(s,this,e),this.levels[0].set(this,t[n].namespace,s)),this._lib_cache.push(t[n].namespace))}}async eval(t,e,s){return(await r(n(d(t),!1),s,"eval-"+Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16))).result(this,e,s)}clone(){const t=new R(null,null,...this.levels);return t._lib_cache=Array.from(this._lib_cache),t}addLevel(t){if(null!=t){if(!(t instanceof m))throw new Error("The level for the context must be heap, or indexed by the heap");this.levels.push(t)}else this.levels.push(new m(this,null))}popLevel(){this.levels.pop()}get(t){let e=null,s=this.levels.length-1;for(;s>=0&&null==(e=this.levels[s--].get(t)););return e}has(t,e="tree"){switch(e){case"tree":return null!==this.get(t);case"up":return this.levels[this.levels.length-1].has(t);case"root":return this.levels[0].has(t)}}set(t,e,s="tree"){let n;switch(s){case"tree":for(n=this.levels.length;--n>=0;)if(null!=this.levels[n].get(t))return void this.levels[n].set(this,t,e);this.levels[this.levels.length-1].set(this,t,e);break;case"up":this.levels[this.levels.length-1].set(this,t,e);break;case"down":this.levels[0].set(this,t,e)}}getByPath(t,e,s=null,n,r=!1){let a=this.get(t[0]),l=null,u=0,c=Array.from(t),d=c.length,h=1;for(;a&&h<d;h++)c[h]instanceof O&&(c[h]=c[h].result(this,null,n).toRawData()),a instanceof N?(l=a,u=a.field_attrs.get(c[h]),a=a.get(c[h])):a instanceof p?a=a[o](c[h],this):(n||console.error)(e,new i(c[h]));return null==s||a instanceof s?r?{instance:a,parent:l,index:h,flags:u}:a:null}toBooleanResult(t){return t instanceof w?t.data:t instanceof E||t instanceof y?0!=t.data:!(t instanceof g)&&(t instanceof N||t instanceof S||(t instanceof A?0!=t.data.length:null!=t))}createObject(t,e,s,n,r=new Array){const i=this.getByPath(s,e,p,n);if(null!=i){let e=new Object;if(t instanceof Map)for(let s of t)r.includes(s[1])||("function"==typeof s[1].result?e[s[0]]=s[1].result(this,null,n):e[s[0]]=s[1]);else if("object"==typeof t&&null!=t)for(let s in t)r.includes(t[s])||("function"==typeof t[s].result?e[s]=t[s].result(this,null,n):e[s]=t[s]);else e=t;switch(!0){case i[u]("String"):return new A(i,e,this);case i[u]("Integer"):return new E(i,e,this);case i[u]("Boolean"):return new w(i,e,this);case i[u]("Number"):return new y(i,e,this);case i[u]("Null"):return new g(i,e,this);case i[u]("Array"):return new S(i,e,this);default:return new N(i,e,this)}}else(n||console.error)(e,new a(s))}}t.exports.Context=R,t.exports.Heap=m},239:(t,e,s)=>{"use strict";const{NAMESPACE:n,SERVICE:r}=s(635),{IOError:i}=s(707),a=s(940),o=s(358),l=s(492),u=s(406),c=Symbol.for("Modules");null==s.g[n]&&(s.g[n]=new Object),null==s.g[n][c]&&(s.g[n][c]=new Map);class d{constructor(t,e=!1,r=!1,i){h(t,this,r),this.namespace=null!=i?i:"space-"+s.g[n][c].size.toString(16)+(e?"-global":""),this.global=Boolean(e),this._fields=new Map}addField(t,e){if(t=String(t),this._fields.has(t))throw new Error('The "'+t+'" field alredy exists');this._fields.set(t,e)}expandPrototype(t){if(!Object.prototype.isPrototypeOf.call(u,t))throw new Error("Only PoonyaPrototype instance can be passed as a prototype.");this._fields.has(t.name)?this._fields.get(t.name).expand(t):this._fields.set(t.name,t)}addLib(t){const e=s.g[n][Symbol.for("Modules")][Symbol.for(t)];if(null==e)throw new Error(`Can't find library with identifier ${t}`);this._fields.set(e.namespace,e)}importTo(t,e,s){for(let[n,i]of this._fields)switch(typeof i){case"bigint":isNaN(i)?t.set(e,n,e.createObject(null,-1,r.CONSTRUCTORS.NULL,s)):t.set(e,n,e.createObject(i,-1,r.CONSTRUCTORS.INTEGER,s));break;case"number":isNaN(i)?t.set(e,n,e.createObject(null,-1,r.CONSTRUCTORS.NULL,s)):t.set(e,n,e.createObject(i,-1,r.CONSTRUCTORS.NUMBER,s));break;case"string":t.set(e,n,e.createObject(i,-1,r.CONSTRUCTORS.STRING,s));break;case"symbol":t.set(e,n,e.createObject(Symbol.keyFor(i),-1,r.CONSTRUCTORS.STRING,s));break;case"function":Object.prototype.isPrototypeOf.call(u,i)?t.set(e,(i=new i(e)).name,i):t.set(e,n,new l(i));break;case"boolean":t.set(e,n,e.createObject(i,-1,r.CONSTRUCTORS.BOOLEAN,s));break;case"undefined":case"object":if(null==i)t.set(e,n,e.createObject(null,-1,r.CONSTRUCTORS.NULL,s));else if(i instanceof d){const o=new a(e.getByPath(r.CONSTRUCTORS.OBJECT,-1,u,s),null);i.importTo(o,e,s),t.set(e,n,o)}else i instanceof Array?t.set(e,n,new o(e.getByPath(r.CONSTRUCTORS.ARRAY,-1,u,s),i,null,e)):t.set(e,n,new a(e.getByPath(r.CONSTRUCTORS.OBJECT,-1,u,s),i,null,e))}}}let h=(t,e,r=!1)=>{if(!r&&null!=s.g[n][c][t=Symbol.for(t)])throw new TypeError("Library, with this id already imported. For "+t.toString());s.g[n][c][t]=e},p=async()=>{};function T(t){if("poonya"===t)return s(294);throw new Error("Unknown module "+t)}p=(t,e)=>{const s=t+"/"+e;return new Promise((async(t,e)=>{try{let e=await fetch(s,{method:"GET"});e=await e.text(),t(new Function("require",`"use strict";${e}`)(T))}catch(t){e(new i(s))}}))},t.exports.Import=t=>{if(!(t instanceof Array))throw new TypeError("import_statements must be Array");const e=new Array;for(let r=0,i=t.length;r<i;r++)e.push(s.g[n][c][Symbol.for(t[r])]);return e},t.exports.ImportFile=p,t.exports.PoonyaStaticLibrary=d},176:(t,e,s)=>{"use strict";const{CHARTYPE:n}=s(635),{fromBytes:r}=s(270);t.exports=class{constructor(t,e,s,n){this.type=t,this.data=r(e),this.position=s-e.length>0?s-e.length+1:0,this.leng=e.length,this.string_separator=null!=n?String.fromCharCode(n):null}equals(t,e){return t==this.type&&(null==e||(Array.isArray(e)?e.includes(this.toString()):this.toString()==e))}contentEquals(t){return Array.isArray(t)?t.includes(this.toRawString()):this.toRawString()==t}toString(){return this.type!=n.STRING?this.data:this.string_separator+this.data+this.string_separator}toRawString(){return this.data}}},513:(t,e,s)=>{"use strict";const{CHARTYPE:n}=s(635),r=s(176);t.exports=function(t,e=!0){if(!Array.isArray(t))throw TypeError("Only array-like data can be input to the lexer");let s=new Array,i=!1,a=!1,o=!1,l=null,u=null,c=null;const d=new Array,h=()=>{s.splice(0,s.length)},p=e=>{s.push(t[e-1],t[e])},T=(...t)=>t.includes(s[1]),f=(...t)=>t.includes(s[s.length-1]);for(let O=1,N=t.length;O<N;O+=2){switch(t[O]){case 32:case 9:u=n.SPACE;break;case 46:u=n.POINT;break;case 10:case 13:u=n.NEWLINE;break;case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:u=n.NUMBER;break;case 34:case 39:case 96:u=n.STRING;break;case 60:case 61:case 62:case 63:case 43:case 44:case 45:case 47:case 40:case 41:case 42:case 59:case 58:case 38:case 123:case 124:case 125:case 91:case 93:case 33:u=n.OPERATOR;break;default:u=n.WORD}if(u===n.NEWLINE&&c===n.NEWLINE||u===n.POINT&&c===n.NUMBER||u===n.NUMBER&&c===n.WORD)p(O);else if(u===n.NUMBER&&c===n.OPERATOR&&T(43,45))c=u,p(O);else{if(u===n.OPERATOR&&c===n.OPERATOR){if(2===s.length&&T(33,60,62)&&61===t[O]){if(p(O),(e||c!==n.SPACE)&&d.push(new r(c,s,O,l)),l=null,h(),c=void 0,O+1===N)return d;continue}if(2===s.length&&T(47)){if(47===t[O]){a=!0,o=!1;continue}if(62===t[O]){a=!0,o=!0;continue}}}if(i||a)if(a){if(o){if(47===t[O]&&f(60)){a=!1,c=void 0,h();continue}}else if(u===n.NEWLINE){a=!1,c=n.NEWLINE,h();continue}p(O)}else{if(u===n.STRING&&t[O]===l){i=!1,c=u;continue}p(O),c=u}else{if(u===c&&c!==n.STRING&&c!==n.OPERATOR||null==c||((e||c!==n.SPACE)&&d.push(new r(c,s,O,l)),l=null,h()),u===n.STRING){i=!0,l=t[O],c=u;continue}p(O),c=u}}}return(e||u!==n.SPACE)&&d.push(new r(u,s,t.length-s.length-1,l)),d}},144:(t,e,s)=>{"use strict";const{maybeEquals:n}=s(270),{CHARTYPE:r}=s(635),{IOError:i}=s(707),a=s(707),o=s(513);t.exports=async function(t,e,s){for(let i=0;;i++){if(null==t[i])return t;if(t[i].equals(r.WORD,"include")&&n(t,i+1,r.NEWLINE)&&t[i+1].equals(r.STRING)){let n,l;if(n=window.location.origin+"/"+e.split("/").slice(0,-1).join("/")+"/"+t[i+1].data.toString(),l=fetch(n,{method:"GET"}).then((t=>t.blob)),null!=e)try{t.splice(i,t[i+2].equals(r.OPERATOR,";")?3:2,...o(await l,!1))}catch(e){s(t[i].position,new a.LinkerIOError(n))}else s(t[i].position,new a.LinkerPathNotGiveExceptrion)}}}},909:(t,e,s)=>{"use strict";const{PoonyaException:n,BadEmptyObjectException:r,ParserEmtyArgumentException:i,UnexpectedTokenException:a,BadArrowNotationJumpingToUpperLevel:o,BadArrowNotationJumpingTwoLevels:l,ParserLogicException:u,InvalidSequenceForLetiableAccessException:c,CriticalParserErrorUnexpectedEndOfInputException:d,SegmentationFaultEmptyArgumentException:h,SegmentationFaultMaximumSegmentsForBlockException:p,UnexpectedTokenStatement:T,UnexpectedWordTypeAndGetException:f,CriticalParserErrorException:O,CriticalParserErrorNoRawDataTransmittedException:N,CriticalParserErrorUnexpectedEndOfExpression:S,ParserUnfinishedNotationException:E}=s(707),{maybeEquals:y,countKeys:A}=s(270),{CHARTYPE:w,SERVICE:g}=s(635),m=s(584),R=s(552),C=s(51),b=s(606),x=s(46),F=s(350),P=s(113),v=s(674),L=s(114),I=s(511),j=s(259),_=s(436),q=s(834),U=s(998),D=s(144);function k(t,e,s,n,r){const i=W(e,s,n,",",1/0,`(${t.map((t=>"number"==typeof t?`[${t}]`:t)).join(" => ")})()`);return{data:new m(t,i.data,r),jump:i.jump}}function M(t,e,s,n,i=0){let u=null,c=0,d=new Array([]),h=e,p=0;for(let T=e;;T++)switch(!0){case void 0===s[T]||3===p&&!s[T].equals(w.OPERATOR,",")||s[T].equals(w.OPERATOR,[";",")"]):return 2!==d[d.length-1].length&&n(s[T].position,new E),{data:new R(t,new Map(d),s[e].position),jump:T-e};case s[T].equals(w.OPERATOR,"*")&&0===p:return 1!==d.length&&n(s[T].position,new r),{data:new R(t,new Map,s[e].position),jump:T-e};case s[T].equals(w.NEWLINE):continue;default:switch(p){case 0:s[T].equals(w.WORD)||s[T].equals(w.STRING)?d[d.length-1][0]=s[T].toRawString():s[T].equals(w.NUMBER)?d[d.length-1][0]=parseInt(s[T].toRawString()):n(s[T].position,new a(s[T],"[Word]")),p=1;continue;case 1:if(c=A(s,T,w.OPERATOR,"-"),c===i+1)T+=c,s[T].equals(w.OPERATOR,">")||n(s[T].position,new a(s[T],">")),p=2;else{if(d.pop(),c<i+1)return{data:new R(t,new Map(d),s[e].position),jump:h-e};n(s[T].position,new o)}continue;case 2:c=A(s,T+1,w.OPERATOR,"-"),null!=s[T+i+3]&&(s[T].equals(w.WORD)||s[T].equals(w.NUMBER))&&c===i+2&&s[T+i+3].equals(w.OPERATOR,">")?(u=M(g.CONSTRUCTORS.OBJECT,T,s,n,i+1),T+=u.jump-1,d[d.length-1][1]=u.data,p=3):c>i+2?n(s[T+1].position,new l):(u=$(T,s,n,[",",";"]),d[d.length-1][1]=u.data,p=3,s[T].equals(w.OPERATOR,";")?T+=u.jump-2:T+=u.jump-1);continue;case 3:d.push([]),h=T,p=0;continue}}}function B(t,e,s,n){let r=0,a=new Array,o=new Array;function l(t){0!==a.length?(o.push($(0,a,n).data),a.splice(0,a.length)):n(null!=t?t.position:s[e],new i)}for(let c=e;;c++)switch(!0){case void 0===s[c]||s[c].equals(w.OPERATOR,";")||s[c].equals(w.NEWLINE)||s[c].equals(w.OPERATOR,")")&&r<=0:return l(s[c]),void 0!==o[0]&&void 0!==o[1]||n(s[e].position,new i),{data:new C(t,o[0],o[1]),jump:c-e-(s[c]&&s[c].equals(w.OPERATOR,")")?1:0)};case s[c].equals(w.OPERATOR,"("):a.push(s[c]),r++;break;case s[c].equals(w.OPERATOR,")"):a.push(s[c]),r--;break;case s[c].equals(w.OPERATOR,":")&&0===r&&0===o.length:l(s[c]);break;case s[c].equals(w.OPERATOR,":")&&0===r&&0!==o.length:n(s[c].position,new u);break;default:a.push(s[c])}}function G(t,e,s){let n=new Array,r=!0,i=0,a=0;if(0===e.length)return{data:[],jump:0};for(let o=t;;o++)switch(!0){case null==e[o]||e[o].equals(w.OPERATOR)&&!e[o].equals(w.OPERATOR,["[","]"])||e[o].equals(w.NEWLINE)||e[o].equals(w.SPACE):return{data:n,jump:o-t};case e[o].equals(w.WORD)&&r:n.push(e[o].toString()),r=!r;continue;case e[o].equals(w.POINT)&&!r:r=!r;continue;case e[o].equals(w.OPERATOR,"[")&&!r:for(o++,i=0,a=o;null!=e[o]&&(!e[o].equals(w.OPERATOR,"]")||0!==i);)e[o].equals(w.OPERATOR,"[")?i++:e[o].equals(w.OPERATOR,"]")&&i--,o++;0!=i&&s(e[o].position,new u),n.push($(0,e.slice(a,o),s).data);continue;default:s(e[o].position,new c);continue}}function $(t,e,s,n=";"){if(0===e.length)return{data:new b(0),jump:0};const r=new b(e[0].position),i=new Array;for(let a=t;;a++){if(null==e[a]||e[a].equals(w.OPERATOR,")")||e[a].contentEquals(n))return r.isNotDone()&&s(e[a-1].position,null==e[a]?new d:new S),r.complete(s),{data:r,jump:a-t};if(!e[a].equals(w.NEWLINE))switch(!0){case e[a].equals(w.WORD):switch(e[a].toString()){case"true":case"false":case"null":r.append(e[a],s);continue}i[0]=G(a,e,s),null!=e[a+i[0].jump]&&e[a+i[0].jump].equals(w.OPERATOR,"(")?(i[1]=k(i[0].data,a+i[0].jump+1,e,s,e[a].position),a+=i[0].jump+i[1].jump+1,r.append(i[1].data,s)):null!=e[a+i[0].jump+1]&&e[a+i[0].jump].equals(w.OPERATOR,"-")&&e[a+i[0].jump+1].equals(w.OPERATOR,">")?(i[1]=M(i[0].data,a+i[0].jump+2,e,s,0),a+=i[0].jump+i[1].jump+1,e[a+1].equals(w.OPERATOR,["*"])&&(a+=1),r.append(i[1].data,s)):(r.append(new x(e[a].position,i[0].data),s),a+=i[0].jump-1);continue;case null!=e[a+1]&&e[a].equals(w.OPERATOR,"-")&&e[a+1].equals(w.OPERATOR,">"):i[0]=M(g.CONSTRUCTORS.OBJECT,a+2,e,s,0),a+=i[0].jump+2,r.append(i[0].data,s);continue;case e[a].equals(w.OPERATOR,"("):i[0]=$(a+1,e,s),a+=i[0].jump+1,r.append(i[0].data,s);continue;case e[a].equals(w.OPERATOR,"?"):return r.complete(s),i[0]=B(new b(e[a].position,r.data),a+1,e,s),{data:i[0].data,jump:a-t+i[0].jump+2};case e[a].equals(w.STRING)||e[a].equals(w.NUMBER)||e[a].equals(w.OPERATOR,["/","*","+","-","!=",">","<",">=","<=","=","|","&"]):r.append(e[a],s);continue;default:return r.isNotDone()&&s(e[a-1].position,new S),r.complete(s),{data:r}}}}function W(t,e,s,n=",",r=1/0,i="unknown"){let a=0,o=[new Array];for(let l=t;;l++)if(!e[l].equals(w.NEWLINE))switch(!0){case void 0===e[l]||e[l].equals(w.OPERATOR,")")&&a<=0:return o.length>0&&o[o.length-1].length>0?o[o.length-1]=$(0,o[o.length-1],s).data:o.length>1?s(e[l-1].position,new h(i)):o.splice(o.length-1,1),{data:o,jump:l-t};case e[l].equals(w.OPERATOR,"("):a++,o[o.length-1].push(e[l]);continue;case e[l].equals(w.OPERATOR,")"):a>0?(a--,o[o.length-1].push(e[l])):s(e[l].position,new u);continue;case e[l].contentEquals(n)&&0===a:o[o.length-1].length>0?(o[o.length-1]=$(0,o[o.length-1],s).data,o.push(new Array),o.length>r&&s(e[l].position,new p(i))):s(e[l].position,new h(i));break;default:o[o.length-1].push(e[l])}}function H(t,e,s){let n=0,r=new Array;for(let i=t;;i++)switch(!0){case void 0===e[i]||e[i].equals(w.OPERATOR,"}")&&n<=0:return{data:Y(0,r,s).data,jump:i-t};case e[i].equals(w.OPERATOR,"{"):n++,r.push(e[i]);continue;case e[i].equals(w.OPERATOR,"}"):n>0?(n--,r.push(e[i])):s(e[i].position,new u);continue;default:r.push(e[i])}}function V(t,e,s){let n=t,r=new Array;if(y(e,n+1,w.NEWLINE)&&e[n+1].equals(w.OPERATOR,"("))if(r[0]=W(n+2,e,s,"",1,"if"),n+=r[0].jump+3,y(e,n,w.NEWLINE)&&e[n].equals(w.OPERATOR,"{")){if(r[1]=H(n+1,e,s),n+=r[1].jump+1,null==e[n+1]||!e[n+1].equals(w.WORD,"else"))return{data:new F(r[0].data[0],r[1].data),jump:n-t};if(y(e,n+2,w.NEWLINE)&&e[n+2].equals(w.OPERATOR,"{"))return r[2]=H(n+3,e,s),n+=r[2].jump+3,{data:new F(r[0].data[0],r[1].data,r[2].data),jump:n-t};if(y(e,n+2,w.NEWLINE)&&e[n+2].equals(w.WORD,"if"))return r[2]=V(n+2,e,s),n+=r[2].jump+2,{data:new F(r[0].data[0],r[1].data,r[2].data),jump:n-t};s(e[n+2].position,new T("else",e[n+2].toString(),"{"))}else s(e[n].position,new T("if",e[n].toString(),"{"));else s(e[n+1].position,new T("if",e[n+1].toString(),"("))}function Y(t,e,s){const r=new P,i=new Array;for(let o=t,l=e.length;;o++)try{if(null==e[o])return{data:r,jump:o-t};switch(!0){case e[o].equals(w.NEWLINE):continue;case e[o].equals(w.OPERATOR,">"):i[0]=$(o+1,e,s),o+=i[0].jump+1,r.push(new v(i[0].data));continue;case e[o].equals(w.WORD,"if"):i[0]=V(o,e,s),o+=i[0].jump,r.push(i[0].data);continue;case e[o].equals(w.WORD,"while"):o+1<l&&y(e,o+1,w.NEWLINE)&&e[o+1].equals(w.OPERATOR,"(")?(i[0]=W(o+2,e,s,"",1,"while"),o+=i[0].jump+3,y(e,o,w.NEWLINE)&&e[o].equals(w.OPERATOR,"{")?(i[1]=H(o+1,e,s),o+=i[1].jump+1,r.push(new L(i[0].data[0],i[1].data))):s(e[o].position,new T("while",e[o].toString(),"{"))):s(e[o+1].position,new T("while",e[o+1].toString(),"("));continue;case e[o].equals(w.WORD,"repeat"):o+1<l&&y(e,o+1,w.NEWLINE)&&e[o+1].equals(w.OPERATOR,"(")?(i[0]=W(o+2,e,s,";",2,"repeat"),o+=i[0].jump+3,y(e,o,w.NEWLINE)&&e[o].equals(w.OPERATOR,"{")?(i[1]=H(o+1,e,s),o+=i[1].jump+1,r.push(new I(i[0].data[0],i[0].data[1],i[1].data))):s(e[o].position,new T("repeat",e[o].toString(),"{"))):s(e[o+1].position,new T("repeat",e[o+1].toString(),"("));continue;case e[o].equals(w.WORD,"set"):if(o+1<l&&y(e,o+1,w.NEWLINE)&&e[o+1].equals(w.WORD)){if(o+2<l&&y(e,o+2,w.NEWLINE)&&e[o+2].equals(w.OPERATOR,"=")){i[0]=$(o+3,e,s),r.push(new j(e[o+1],i[0].data)),o+=i[0].jump+3;continue}s(e[o+3].position,new f(e[o+2].toString(),e[o+2].type))}else s(e[o+2].position,new f(e[o+1].toString(),e[o+1].type));break;case e[o].equals(w.WORD):i[0]=G(o,e,s),o+i[0].jump<l?e[o+i[0].jump].equals(w.OPERATOR,"=")?(i[1]=$(i[0].jump+o+1,e,s),r.push(new _(e[o+i[0].jump].position,i[0].data,i[1].data)),o+=i[0].jump+i[1].jump+1):e[o+i[0].jump].equals(w.OPERATOR,"<")?e[o+i[0].jump+1].equals(w.OPERATOR,"-")?(i[1]=$(i[0].jump+o+2,e,s),r.push(new q(e[o+i[0].jump].position,i[0].data,i[1].data)),o+=i[0].jump+i[1].jump+2):s(e[o+i[0].jump+1].position,new a(e[o+i[0].jump+1].toString(),"-")):e[o+i[0].jump].equals(w.OPERATOR,"(")?(i[1]=$(o,e,s),r.push(i[1].data),o+=i[1].jump):s(e[o].position,new c):o+=i[0].jump;continue;case e[o].equals(w.NUMBER)||e[o].equals(w.STRING):i[0]=$(o,e,s),r.push(i[0].data),o+=i[0].jump;continue;default:s(e[o].position,new a(e[o].toString(),"*"))}}catch(t){if(t instanceof n)throw t;0!=e.length?null!=e[o]?s(e[o].position,new O):s(e[e.length-1].position,new d):s(0,new N)}}t.exports.parser=async function(t,e,s){return new U(Y(0,await D(t,s,e),e).data.Sequence)},t.exports.parserMP=async function(t,e,s,n){let r=0,i=new Array,o=new U;for(let a=0;null!=t[a];a++)if((null==e&&t[a].equals(w.OPERATOR,"{")||null!=e&&t[a].contentEquals(e.toString())&&(t[a+1].equals(w.OPERATOR,"{")||t[a+1].equals(w.SPACE)&&t[a+2].equals(w.OPERATOR,"{")))&&0===r)null!=e&&(a+=t[a+1].equals(w.SPACE)?2:1),i.length>0&&(o.push(new v(new R(g.CONSTRUCTORS.STRING,i.join(""),t[a].position))),i.splice(0,i.length)),r++;else if(t[a].equals(w.OPERATOR,"}")&&1===r)o.push(Y(0,await D(i.filter((t=>t.type!==w.SPACE)),n,s),s).data),i.splice(0,i.length),r--;else{if(r>=1)switch(!0){case t[a].equals(w.OPERATOR,"{"):r++;break;case t[a].equals(w.OPERATOR,"}"):r--}0===!r?i.push(t[a].toString()):i.push(t[a])}return 0!==i.length&&(1===r?(o.push(Y(0,await D(i.filter((t=>t.type!==w.SPACE)),n,s),s).data),i.splice(0,i.length)):0===r?0!=i.length&&(o.push(new v(new R(g.CONSTRUCTORS.STRING,i.join(""),t[t.length-1].position))),i.splice(0,i.length)):s(t[t.length-1].position,new a(t[t.length-1],"}"))),o},t.exports.parseExpression=$},174:(t,e,s)=>{"use strict";t=s.nmd(t),window.setImmediate||(window.setImmediate=function(){var t={},e=t,s=Math.random();function n(e){if(e.data==s){var n=(t=t.next).func;delete t.func,n()}}return window.addEventListener?window.addEventListener("message",n):window.attachEvent("onmessage",n),function(t){e=e.next={func:t},window.postMessage(s,"*")}}());const{EventEmitter:n}=s(245),{IOError:r,PoonyaException:i}=s(707),{Import:a,ImportDir:o,ImportFile:l}=s(239),{Context:u,Heap:c}=s(392),{parser:d,parseExpression:h,parserMP:p}=s(909),{SERVICE:T}=s(635),{toFixed:f,toBytes:O,fromBytes:N}=s(270),{iPoonyaConstructsData:S}=s(779),E=s(513),y=Symbol("RESULT"),A=Symbol("INIT");class w extends n{constructor(){super(),this._data=new Array,this._ended=!1}toReadable(){const t=this;return new ReadableStream({start(e){t.on("data",e.enqueue.bind(e)),t.on("end",e.close.bind(e))}})}pipe(t){if("function"==typeof t.write)return this.on("data",t.write.bind(t)),t;throw new TypeError("Is not a WriteStream")}write(t){this._data.push(t),this.emit("data",t)}end(){this._ended=!0,this.emit("end")}complete(){return this._ended?this._data:new Promise((t=>this.on("end",(()=>t(this._data)))))}}class g extends n{constructor(t,e=[],s=console,n){super();const i=this;if(i.input=null,i.loaded=!1,i.logger=s,"string"==typeof t)i.input=t,i.charset="utf-8",i.path=window.location.href,T.LOADED?(i[A](e,s),setImmediate((()=>n.call(i)))):T.ACTIONS.on("load",(()=>{i[A](e,s),n.call(i)}));else{if("object"!=typeof t)throw new Error("BAD_DATA_FORMAT");if(i.charset="string"==typeof t.charset?t.charset:"utf-8",i.path="string"==typeof t.path?t.path.split("/").pop().split(".").length>0?t.path:t.path+".po":"anonymous.po","string"==typeof t.raw)i.input=t.raw;else{if("string"!=typeof t.path)throw new Error("BAD_DATA_FORMAT");try{fetch(t.path,{method:"GET"}).catch((t=>{throw t})).then((t=>t.text())).then((t=>{i.input=t,T.LOADED?(i[A](e,s),n.call(i)):T.ACTIONS.on("load",(()=>{i[A](e,s),n.call(i)}))}))}catch(e){throw new r(t.path)}}}}throwError(t,e,s=5){s=parseInt(s);let n=[],r=this.input.split("\n"),a=N(O(this.input).slice(0,t)).split("\n"),o=a.length-1,l=o-parseInt(s/2)<0?0:o-parseInt(s/2),u=l+s<r.length?l+s:r.length,c=u.toString(16).length+2;if(n.push("  at ",this.path,":",o+1,":",a[o].length+1),-1!=t){n.push(" :>\n");for(let t=l;t<u;t++)n.push("     ",f(t+1,c)," |> ",r[t]),t===o&&n.push("\n     ".padEnd(c+6," ")," |> ".padEnd(a[o].length+4," "),"^"),t+1!==u&&n.push("\n")}throw e instanceof i?(e.message+="\n"+n.join(""),e):new i(e,n.join(""))}[A](t,e){this.libraries=a(["default",...t],e),this.import=t,this.data=null}[y](t,e,s){if(Array.isArray(t)){for(let e=0,s=t.length;e<s;e++)"object"!=typeof t[e]||t[e]instanceof c||(t[e]=new c(null,t[e]));if(null!=t.find((t=>!(t instanceof c))))throw new TypeError("Data must have a Heap type");this.data.result(new u(this.libraries,e,...t),s,e),s.end()}else if(t instanceof u){const n=t.clone();n.import(this.libraries,e),this.data.result(n,s,e),s.end()}else{if("object"!=typeof t||t instanceof c||(t=new c(null,t)),!(t instanceof c))throw new TypeError("Data must have a Heap type");this.data.result(new u(this.libraries,e,t),s,e),s.end()}}result(t=new c,e=this.throwError.bind(this)){const s=new w;return this.loaded?setImmediate((()=>this[y](t,e,s))):this.addListener("load",(()=>this[y](t,e,s))),s}}class m extends g{constructor(t,e="poonya",s,n=console){super(t,s,n,(async()=>{try{this.data=await p(E(O(this.input)),e,this.throwError.bind(this),this.path)}catch(t){this.emit("error",t)}this.loaded=!0,this.emit("load")}))}}class R extends g{constructor(t,e,s=console){super(t,e,s,(async()=>{try{this.data=await d(E(O(this.input),!1),this.throwError.bind(this),this.path)}catch(t){this.emit("error",t)}this.loaded=!0,this.emit("load")}))}}(async()=>{s(548),s(449),T.ACTIONS.emit("load")})(),(()=>{const t=new Event("poonya:load");document.addEventListener("DOMContentLoaded",(async()=>{const e=document.querySelectorAll('script[type="text/poonya"], script[lang="text/poonya"]');for(let t,s,n,r,i,a,o=0,l=e.length;o<l;o++){if(t=e[o].getAttribute("name")??"block-"+o,s=e[o].getAttribute("handler")??"exec",n=(e[o].getAttribute("import")??"").split("|"),r=new Event("poonya:load:"+t),i=new Event("poonya:error:"+t),"exec"==s)a=new R(e[o].innerHTML,n);else{if("message"!=s)throw new Error('Unknown pattern handler in block "'+t+'" type "'+s+'"');a=new m(e[o].innerHTML,n)}await new Promise(((t,s)=>{a.on("load",(async()=>{e[o].replaceWith(...(await a.result().complete()).map((t=>{return e=t,(s=document.createElement("template")).innerHTML=e,s.content.cloneNode(!0);var e,s}))),window.dispatchEvent(r),t()})),a.on("error",(e=>{window.dispatchEvent(i),t()}))}))}window.dispatchEvent(t)}))})(),t.exports.CodeEmitter=g,t.exports.MessagePattern=m,t.exports.PoonyaOutputStream=w,t.exports.ExpressionPattern=class extends g{constructor(t,e,s=console){super(t,e,s,(()=>{try{this.data=h(0,E(O(this.input),!1),this.throwError.bind(this)).data}catch(t){this.emit("error",t)}this.loaded=!0,this.emit("load")}))}[y](t,e){if(t instanceof u){const s=t.clone();return s.import(this.libraries,e),this.data.result(s,[],e)}if(Array.isArray(t)){for(let e=0,s=t.length;e<s;e++)"object"!=typeof t[e]||t[e]instanceof c||(t[e]=new c(null,t[e]));if(null==t.find((t=>!(t instanceof c))))return this.data.result(new u(this.libraries,e,...t),[],e);throw new TypeError("Data must have a Heap type")}if("object"!=typeof t||t instanceof c||(t=new c(null,t)),t instanceof c)return this.data.result(new u(this.libraries,e,t),[],e);throw new TypeError("Data must have a Heap type")}result(t=new c,e=this.throwError.bind(this)){const s=this;return new Promise((n=>{s.loaded?n(s[y](t,e)):s.on("load",(()=>n(s[y](t,e))))}))}},t.exports.ExecutionPattern=R,t.exports.patternCreator=function(t,...e){if(Object.prototype.isPrototypeOf.call(g,t))return t=Function.prototype.apply(Object.create(t),e),new Promise(((e,s)=>{t.on("load",((...s)=>e(Object.assign(new S,{Pattern:t,args:s})))),t.on("error",((...e)=>s(Object.assign(new S,{Pattern:t,args:e}))))}));throw new Error('The "Pattern" must be a "CodeEmitter" heir')},t.exports.createContext=function(t,...e){if("object"!=typeof t||null==t)throw new Error('Param "data" must be an object.');return e=e.flat(1/0).filter((t=>"string"!=typeof t)),new Promise((s=>{T.LOADED?s(new u(a(["default",...e]),g.prototype.throwError.bind({input:"",charset:"utf-8",path:"untitled.po"}),t)):T.ACTIONS.on("load",(()=>{s(new u(a(["default",...e]),g.prototype.throwError.bind({input:"",charset:"utf-8",path:"untitled.po"}),t))}))}))},t.exports.ImportFile=l.bind(null,null!=t.parent?t.parent.path:t.path)},294:(t,e,s)=>{"use strict";t.exports.FIELDFLAGS=s(635).FIELDFLAGS,t.exports.Exceptions=s(707),t.exports.PoonyaStaticLibrary=s(239).PoonyaStaticLibrary,t.exports.PoonyaPrototype=s(406)},270:(t,e,s)=>{"use strict";const{SERVICE:n}=s(635),{Operand:r}=s(62),{iPoonyaObject:i,iPoonyaPrototype:a}=s(779),o=s(492);t.exports.maybeEquals=function(t,e,s,n){for(;t[e].equals(s,n);)t.splice(e,1);return!0},t.exports.countKeys=function(t,e,s,n){for(let r=e,i=t.length;r<i;r++)if(null==t[r]||!t[r].equals(s,n))return r-e},t.exports.fromBytes=function(t){let e="";for(let s=0,n=t.length;s<n;s+=2)e+=String.fromCharCode(t[s]<<8|t[s+1]);return e},t.exports.toFixed=function(t,e){return"0x"+t.toString(16).padStart(e-2,"0")},t.exports.toBytes=function(t){let e=new Array;for(let s,n=0,r=t.length;n<r;n++)e.push((s=t.charCodeAt(n))>>>8,255&s);return e},t.exports.Cast=function(t,e,s=new Array){switch(typeof t){case"bigint":return e.createObject(t,-1,n.CONSTRUCTORS.INTEGER,null,s);case"number":return e.createObject(t,-1,n.CONSTRUCTORS.NUMBER,null,s);case"string":return e.createObject(t,-1,n.CONSTRUCTORS.STRING,null,s);case"symbol":return e.createObject(Symbol.keyFor(t),-1,n.CONSTRUCTORS.STRING,null,s);case"boolean":return e.createObject(t,-1,n.CONSTRUCTORS.BOOLEAN,null,s);case"undefined":return e.createObject(t,-1,n.CONSTRUCTORS.NULL,null);case"object":switch(!0){case null===t:return e.createObject(t,-1,n.CONSTRUCTORS.NULL,null,s);case t instanceof i:case t instanceof a:case t instanceof r:case t instanceof o:return t;default:return s.push(t),Array.isArray(t)?e.createObject(t,-1,n.CONSTRUCTORS.ARRAY,null,s):e.createObject(t,-1,n.CONSTRUCTORS.OBJECT,null,s)}case"function":return new o(t)}}},386:()=>{}},e={};function s(n){if(e[n])return e[n].exports;var r=e[n]={id:n,loaded:!1,exports:{}};return t[n](r,r.exports,s),r.loaded=!0,r.exports}return s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),s.nmd=t=>(t.paths=[],t.children||(t.children=[]),t),s(174)})())}}}));